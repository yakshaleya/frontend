var y=function(e){this.value=e};y.math={isDegree:!0,acos:function(e){return y.math.isDegree?180/Math.PI*Math.acos(e):Math.acos(e)},add:function(e,t){return e+t},asin:function(e){return y.math.isDegree?180/Math.PI*Math.asin(e):Math.asin(e)},atan:function(e){return y.math.isDegree?180/Math.PI*Math.atan(e):Math.atan(e)},acosh:function(e){return Math.log(e+Math.sqrt(e*e-1))},asinh:function(e){return Math.log(e+Math.sqrt(e*e+1))},atanh:function(e){return Math.log((1+e)/(1-e))},C:function(e,t){var u=1,a=e-t,o=t;o<a&&(o=a,a=t);for(var n=o+1;n<=e;n++)u*=n;return u/y.math.fact(a)},changeSign:function(e){return-e},cos:function(e){return y.math.isDegree&&(e=y.math.toRadian(e)),Math.cos(e)},cosh:function(e){return(Math.pow(Math.E,e)+Math.pow(Math.E,-1*e))/2},div:function(e,t){return e/t},fact:function(e){if(e%1!==0)return"NaN";for(var t=1,u=2;u<=e;u++)t*=u;return t},inverse:function(e){return 1/e},log:function(e){return Math.log(e)/Math.log(10)},mod:function(e,t){return e%t},mul:function(e,t){return e*t},P:function(e,t){for(var u=1,a=Math.floor(e)-Math.floor(t)+1;a<=Math.floor(e);a++)u*=a;return u},Pi:function(e,t,u){for(var a=1,o=e;o<=t;o++)a*=Number(u.postfixEval({n:o}));return a},pow10x:function(e){for(var t=1;e--;)t*=10;return t},sigma:function(e,t,u){for(var a=0,o=e;o<=t;o++)a+=Number(u.postfixEval({n:o}));return a},sin:function(e){return y.math.isDegree&&(e=y.math.toRadian(e)),Math.sin(e)},sinh:function(e){return(Math.pow(Math.E,e)-Math.pow(Math.E,-1*e))/2},sub:function(e,t){return e-t},tan:function(e){return y.math.isDegree&&(e=y.math.toRadian(e)),Math.tan(e)},tanh:function(e){return y.sinha(e)/y.cosha(e)},toRadian:function(e){return e*Math.PI/180},and:function(e,t){return e&t}};y.Exception=function(e){this.message=e};var G=y,p=G;function i(e,t){for(var u=0;u<e.length;u++)e[u]+=t;return e}var E=[{token:"sin",show:"sin",type:0,value:p.math.sin},{token:"cos",show:"cos",type:0,value:p.math.cos},{token:"tan",show:"tan",type:0,value:p.math.tan},{token:"pi",show:"&pi;",type:3,value:"PI"},{token:"(",show:"(",type:4,value:"("},{token:")",show:")",type:5,value:")"},{token:"P",show:"P",type:10,value:p.math.P},{token:"C",show:"C",type:10,value:p.math.C},{token:" ",show:" ",type:14,value:" ".anchor},{token:"asin",show:"asin",type:0,value:p.math.asin},{token:"acos",show:"acos",type:0,value:p.math.acos},{token:"atan",show:"atan",type:0,value:p.math.atan},{token:"7",show:"7",type:1,value:"7"},{token:"8",show:"8",type:1,value:"8"},{token:"9",show:"9",type:1,value:"9"},{token:"int",show:"Int",type:0,value:Math.floor},{token:"cosh",show:"cosh",type:0,value:p.math.cosh},{token:"acosh",show:"acosh",type:0,value:p.math.acosh},{token:"ln",show:" ln",type:0,value:Math.log},{token:"^",show:"^",type:10,value:Math.pow},{token:"root",show:"root",type:0,value:Math.sqrt},{token:"4",show:"4",type:1,value:"4"},{token:"5",show:"5",type:1,value:"5"},{token:"6",show:"6",type:1,value:"6"},{token:"/",show:"&divide;",type:2,value:p.math.div},{token:"!",show:"!",type:7,value:p.math.fact},{token:"tanh",show:"tanh",type:0,value:p.math.tanh},{token:"atanh",show:"atanh",type:0,value:p.math.atanh},{token:"Mod",show:" Mod ",type:2,value:p.math.mod},{token:"1",show:"1",type:1,value:"1"},{token:"2",show:"2",type:1,value:"2"},{token:"3",show:"3",type:1,value:"3"},{token:"*",show:"&times;",type:2,value:p.math.mul},{token:"sinh",show:"sinh",type:0,value:p.math.sinh},{token:"asinh",show:"asinh",type:0,value:p.math.asinh},{token:"e",show:"e",type:3,value:"E"},{token:"log",show:" log",type:0,value:p.math.log},{token:"0",show:"0",type:1,value:"0"},{token:".",show:".",type:6,value:"."},{token:"+",show:"+",type:9,value:p.math.add},{token:"-",show:"-",type:9,value:p.math.sub},{token:",",show:",",type:11,value:","},{token:"Sigma",show:"&Sigma;",type:12,value:p.math.sigma},{token:"n",show:"n",type:13,value:"n"},{token:"Pi",show:"&Pi;",type:12,value:p.math.Pi},{token:"pow",show:"pow",type:8,value:Math.pow,numberOfArguments:2},{token:"&",show:"&",type:9,value:p.math.and}],x={0:11,1:0,2:3,3:0,4:0,5:0,6:0,7:11,8:11,9:1,10:10,11:0,12:11,13:0,14:-1,15:11};for(var b=0;b<E.length;b++)E[b].precedence=x[E[b].type];var g={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,9:!0,12:!0,13:!0,14:!0,15:!0},k={0:!0,1:!0,2:!0,3:!0,4:!0,5:!0,6:!0,7:!0,8:!0,9:!0,10:!0,11:!0,12:!0,13:!0,15:!0},U={0:!0,3:!0,4:!0,8:!0,12:!0,13:!0,15:!0},m={},A={0:!0,1:!0,3:!0,4:!0,6:!0,8:!0,12:!0,13:!0,15:!0},W={1:!0},w=[[],["1","2","3","7","8","9","4","5","6","+","-","*","/","(",")","^","!","P","C","e","0",".",",","n"," ","&"],["pi","ln","Pi"],["sin","cos","tan","Del","int","Mod","log","pow"],["asin","acos","atan","cosh","root","tanh","sinh"],["acosh","atanh","asinh","Sigma"]];function L(e,t,u,a){for(var o=0;o<a;o++)if(e[u+o]!==t[o])return!1;return!0}p.tokenTypes={FUNCTION_WITH_ONE_ARG:0,NUMBER:1,BINARY_OPERATOR_HIGH_PRECENDENCE:2,CONSTANT:3,OPENING_PARENTHESIS:4,CLOSING_PARENTHESIS:5,DECIMAL:6,POSTFIX_FUNCTION_WITH_ONE_ARG:7,FUNCTION_WITH_N_ARGS:8,BINARY_OPERATOR_LOW_PRECENDENCE:9,BINARY_OPERATOR_PERMUTATION:10,COMMA:11,EVALUATED_FUNCTION:12,EVALUATED_FUNCTION_PARAMETER:13,SPACE:14};p.addToken=function(e){for(var t=0;t<e.length;t++){var u=e[t].token.length,a=-1;e[t].type===p.tokenTypes.FUNCTION_WITH_N_ARGS&&e[t].numberOfArguments===void 0&&(e[t].numberOfArguments=2),w[u]=w[u]||[];for(var o=0;o<w[u].length;o++)if(e[t].token===w[u][o]){a=F(w[u][o],E);break}a===-1?(E.push(e[t]),e[t].precedence=x[e[t].type],w.length<=e[t].token.length&&(w[e[t].token.length]=[]),w[e[t].token.length].push(e[t].token)):(E[a]=e[t],e[t].precedence=x[e[t].type])}};function F(e,t){for(var u=0;u<t.length;u++)if(t[u].token===e)return u;return-1}function B(e){for(var t=[],u=e.length,a,o,n,r=0;r<u;r++)if(!(r<u-1&&e[r]===" "&&e[r+1]===" ")){for(a="",o=e.length-r>w.length-2?w.length-1:e.length-r;o>0;o--)if(w[o]!==void 0)for(n=0;n<w[o].length;n++)L(e,w[o][n],r,o)&&(a=w[o][n],n=w[o].length,o=0);if(r+=a.length-1,a==="")throw new p.Exception("Can't understand after "+e.slice(r));t.push(E[F(a,E)])}return t}var $={value:p.math.changeSign,type:0,pre:21,show:"-"},C={value:")",show:")",type:5,pre:0},O={value:"(",type:4,pre:0,show:"("};p.lex=function(e,t){var u=[O],a=[],o=e,n=g,r=0,h=m,l="",s;typeof t<"u"&&p.addToken(t);var c={},d=B(o);for(s=0;s<d.length;s++){var M=d[s];if(M.type===14){if(s>0&&s<d.length-1&&d[s+1].type===1&&(d[s-1].type===1||d[s-1].type===6))throw new p.Exception("Unexpected Space");continue}var _=M.token,v=M.type,N=M.value,D=M.precedence,R=M.show,f=u[u.length-1],P;for(P=a.length;P--&&a[P]===0;)if([0,2,3,4,5,9,11,12,13].indexOf(v)!==-1){if(n[v]!==!0)throw new p.Exception(_+" is not allowed after "+l);u.push(C),n=k,h=A,a.pop()}if(n[v]!==!0)throw new p.Exception(_+" is not allowed after "+l);if(h[v]===!0&&(v=2,N=p.math.mul,R="&times;",D=3,s=s-1),c={value:N,type:v,pre:D,show:R,numberOfArguments:M.numberOfArguments},v===0)n=g,h=m,i(a,2),u.push(c),d[s+1].type!==4&&(u.push(O),a.push(2));else if(v===1)f.type===1?(f.value+=N,i(a,1)):u.push(c),n=k,h=U;else if(v===2)n=g,h=m,i(a,2),u.push(c);else if(v===3)u.push(c),n=k,h=A;else if(v===4)i(a,1),r++,n=g,h=m,u.push(c);else if(v===5){if(!r)throw new p.Exception("Closing parenthesis are more than opening one, wait What!!!");r--,n=k,h=A,u.push(c),i(a,1)}else if(v===6){if(f.hasDec)throw new p.Exception("Two decimals are not allowed in one number");f.type!==1&&(f={value:0,type:1,pre:0},u.push(f)),n=W,i(a,1),h=m,f.value+=N,f.hasDec=!0}else v===7&&(n=k,h=A,i(a,1),u.push(c));v===8?(n=g,h=m,i(a,M.numberOfArguments+2),u.push(c),d[s+1].type!==4&&(u.push(O),a.push(M.numberOfArguments+2))):v===9?(f.type===9?f.value===p.math.add?(f.value=N,f.show=R,i(a,1)):f.value===p.math.sub&&R==="-"&&(f.value=p.math.add,f.show="+",i(a,1)):f.type!==5&&f.type!==7&&f.type!==1&&f.type!==3&&f.type!==13?_==="-"&&(n=g,h=m,i(a,2).push(2),u.push($),u.push(O)):(u.push(c),i(a,2)),n=g,h=m):v===10?(n=g,h=m,i(a,2),u.push(c)):v===11?(n=g,h=m,u.push(c)):v===12?(n=g,h=m,i(a,6),u.push(c),d[s+1].type!==4&&(u.push(O),a.push(6))):v===13&&(n=k,h=A,u.push(c)),i(a,-1),l=_}for(P=a.length;P--;)u.push(C);if(n[5]!==!0)throw new p.Exception("complete the expression");for(;r--;)u.push(C);return u.push(C),new p(u)};var q=p,S=q;S.prototype.toPostfix=function(){for(var e=[],t,u,a,o,n,r=[{value:"(",type:4,pre:0}],h=this.value,l=1;l<h.length;l++)if(h[l].type===1||h[l].type===3||h[l].type===13)h[l].type===1&&(h[l].value=Number(h[l].value)),e.push(h[l]);else if(h[l].type===4)r.push(h[l]);else if(h[l].type===5)for(;(u=r.pop()).type!==4;)e.push(u);else if(h[l].type===11){for(;(u=r.pop()).type!==4;)e.push(u);r.push(u)}else{t=h[l],o=t.pre,n=r[r.length-1],a=n.pre;var s=n.value=="Math.pow"&&t.value=="Math.pow";if(o>a)r.push(t);else{for(;a>=o&&!s||s&&o<a;)u=r.pop(),n=r[r.length-1],e.push(u),a=n.pre,s=t.value=="Math.pow"&&n.value=="Math.pow";r.push(t)}}return new S(e)};var Y=S,I=Y;I.prototype.postfixEval=function(e){e=e||{},e.PI=Math.PI,e.E=Math.E;for(var t=[],u,a,o,n=this.value,r=typeof e.n<"u",h=0;h<n.length;h++)if(n[h].type===1)t.push({value:n[h].value,type:1});else if(n[h].type===3)t.push({value:e[n[h].value],type:1});else if(n[h].type===0)typeof t[t.length-1].type>"u"?t[t.length-1].value.push(n[h]):t[t.length-1].value=n[h].value(t[t.length-1].value);else if(n[h].type===7)typeof t[t.length-1].type>"u"?t[t.length-1].value.push(n[h]):t[t.length-1].value=n[h].value(t[t.length-1].value);else if(n[h].type===8){for(var l=[],s=0;s<n[h].numberOfArguments;s++)l.push(t.pop().value);t.push({type:1,value:n[h].value.apply(n[h],l.reverse())})}else n[h].type===10?(u=t.pop(),a=t.pop(),typeof a.type>"u"?(a.value=a.concat(u),a.value.push(n[h]),t.push(a)):typeof u.type>"u"?(u.unshift(a),u.push(n[h]),t.push(u)):t.push({type:1,value:n[h].value(a.value,u.value)})):n[h].type===2||n[h].type===9?(u=t.pop(),a=t.pop(),typeof a.type>"u"?(a=a.concat(u),a.push(n[h]),t.push(a)):typeof u.type>"u"?(u.unshift(a),u.push(n[h]),t.push(u)):t.push({type:1,value:n[h].value(a.value,u.value)})):n[h].type===12?(u=t.pop(),typeof u.type<"u"&&(u=[u]),a=t.pop(),o=t.pop(),t.push({type:1,value:n[h].value(o.value,a.value,new I(u))})):n[h].type===13&&(r?t.push({value:e[n[h].value],type:3}):t.push([n[h]]));if(t.length>1)throw new I.Exception("Uncaught Syntax error");return t[0].value>1e15?"Infinity":parseFloat(t[0].value.toFixed(15))};I.eval=function(e,t,u){return typeof t>"u"?this.lex(e).toPostfix().postfixEval():typeof u>"u"?typeof t.length<"u"?this.lex(e,t).toPostfix().postfixEval():this.lex(e).toPostfix().postfixEval(t):this.lex(e,t).toPostfix().postfixEval(u)};var V=I,H=V;H.prototype.formulaEval=function(){for(var e,t,u,a=[],o=this.value,n=0;n<o.length;n++)o[n].type===1||o[n].type===3?a.push({value:o[n].type===3?o[n].show:o[n].value,type:1}):o[n].type===13?a.push({value:o[n].show,type:1}):o[n].type===0?a[a.length-1]={value:o[n].show+(o[n].show!="-"?"(":"")+a[a.length-1].value+(o[n].show!="-"?")":""),type:0}:o[n].type===7?a[a.length-1]={value:(a[a.length-1].type!=1?"(":"")+a[a.length-1].value+(a[a.length-1].type!=1?")":"")+o[n].show,type:7}:o[n].type===10?(e=a.pop(),t=a.pop(),o[n].show==="P"||o[n].show==="C"?a.push({value:"<sup>"+t.value+"</sup>"+o[n].show+"<sub>"+e.value+"</sub>",type:10}):a.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+"<sup>"+e.value+"</sup>",type:1})):o[n].type===2||o[n].type===9?(e=a.pop(),t=a.pop(),a.push({value:(t.type!=1?"(":"")+t.value+(t.type!=1?")":"")+o[n].show+(e.type!=1?"(":"")+e.value+(e.type!=1?")":""),type:o[n].type})):o[n].type===12&&(e=a.pop(),t=a.pop(),u=a.pop(),a.push({value:o[n].show+"("+u.value+","+t.value+","+e.value+")",type:12}));return a[0].value};var z=H;export{z as f};
